<html>

<head>
    <style>
        h4 {
            margin: 0;
        }

        body {
            margin: 0;
        }
    </style>
</head>

<body>
    <h4><span id="timeframe-display"></span></h4>

    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container" style="height: 100%; width: 100%;">
        <div class="tradingview-widget-container__widget" style="height: calc(100% - 32px); width: 100%;"></div>
        <div class="tradingview-widget-copyright">
            <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
                <span class="blue-text">Track all markets on TradingView</span>
            </a>
        </div>
        <script type="text/javascript">
            // Function to get URL parameters
            function getUrlParameter(name) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(name);
            }

            // Get 'symbol' and 'timeframe' from the URL
            const symbol = getUrlParameter('symbol') || 'COINBASE:ADAUSD'; // Default value if not provided
            const timeframe = getUrlParameter('timeframe') || '240'; // Default value if not provided

            // Set the timeframe in the <h4> span
            document.getElementById('timeframe-display').textContent = `Timeframe: ${timeframe}`;

            // Inject the TradingView widget script with dynamic parameters
            const widgetScript = document.createElement('script');
            widgetScript.type = 'text/javascript';
            widgetScript.src = "https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js";
            widgetScript.async = true;
            widgetScript.innerHTML = JSON.stringify({
                autosize: true,
                symbol: symbol,
                interval: timeframe,
                timezone: "Etc/UTC",
                theme: "dark",
                style: "1",
                locale: "en",
                allow_symbol_change: true,
                calendar: false,
                support_host: "https://www.tradingview.com"
            });

            // Append the script to the container
            document.querySelector('.tradingview-widget-container').appendChild(widgetScript);
        </script>
    </div>
    <!-- TradingView Widget END -->
</body>

</html>